# <> Release 2.16 - Features & Fixes
This update lays the groundwork for any `Premiere` theme to be supported; not just the `darkest` theme. While actual full support is unlikely to ever be a priority in the development of this repo, this update makes it possible in the future to at least offer it as a basic feature if it is ever desired.

> [!Caution]
> If the user uses `PremiereRemote` and isn't doing a clean install, this release requires the user to run `..\Backups\Adobe Backups\Premiere\PremiereRemote\replacePremRemote.ahk` as some functions have been updated.

## Functions
- âœ… Fixed `getHotkeys()` not handling hotkeys that discern either the left or right pair (eg. <kbd><!2</kbd>)
- âœ… Fixed `getScriptRelease()` throwing if no URL is determined in some html
- âœï¸ Added `cmd.exploreAndHighlight()`
- âœï¸ Added `selectFileInOpenWindow()`
- âœï¸ Added [`nItemsInDir()`](<https://www.autohotkey.com/boards/viewtopic.php?p=494290#p494290>)
- âœï¸ Added `syncDirectories()`
- âœï¸ Added `switchTo.explorerHighlightFile()`
- ğŸ“‹ `block_ext {` now allows <kbd>Escape</kbd> by default so that <kbd>Ctrl + Shift + Escape</kbd> is accessible even while inputs are blocked

### ğŸ“ `ffmpeg {`
- âœï¸ Added `isVideo()`
- ğŸ“‹ Alert tooltip on completion can now be silenced by setting `doAlert` to `false`

### ğŸ“ `ytdlp {`
- ğŸ“‹ Alert tooltip on completion can now be silenced by setting `doAlert` to `false`

ğŸ“ `download()`
- âœ… Fixed function incorrectly naming some files causing subsequent functionality to fail
- âœ… Fixed function sometimes failing to index correctly causing duplicate downloads to cancel
- ğŸ“‹ Will attempt to select the downloaded file in the `explorer` window if `openDirOnFinish` is set to `true`

### ğŸ“ `prem {`
- âœ… Fixed `save()` using incorrect logic and incorrectly determining premiere as `busy`
- âœ… Fixed `rippleTrim()` tracking incorrectly
- âœ… Fixed `disableDirectManip()` not unblocking inputs in some scenarios
- âœ… Fixed `gain()` not unblocking inputs if the function is interrupted before the `Audio Gain` window is closed (will now only wait `1.5s` before continuing)
- âœï¸ Added `toggleEnabled()`
- âœï¸ Added `soloVideo()`
- âœï¸ Added `swapPreviousSequence()`
- âœï¸ Added `closeActiveSequence()`
- ğŸ“‹ `toggleLayerButtons()` will now wait for some activation hotkeys to be released before continuing
- ğŸ“‹ `changeLabel()` will no longer focus the timeline if the `Projects` window is the active panel so that the user may still assign labels to sequences
- ğŸ“‹ Theme selection is now determined automatically (for Premiere versions greater than `v25.0`) using the user's Premiere settings file, or through `settingsGUI()` for versions before `v25.0`
    - â— `rbuttonPrem().movePlayhead` no longer requires the user's theme to be passed in as a parameter
> [!Warning]
> Keep in mind only the `darkest` theme has its colours set within `timelineColours {` currently & additionally that basically all `ImageSearch` screenshots across the repo are taken in the `darkest` theme (and with `Accessible Colour Contrast` **disabled**).  
> If you use an alternative theme, please update `Premiere_TimelineColours.ahk`, and take fresh screenshots, then consider submitting a pull request!  
> Currently functionality to swap between multiple theme screenshots does not exist as I do not have the capacity to maintain them myself but I am not against building in that swapping functionality (with disclaimers) if there is a need for it.

ğŸ“ `numpadGain()`
- ğŸ“‹ Will now exit early if no clip is selected instead of needing to timeout
- â— `PremiereRemote` is now required

ğŸ“ `delayPlayback()`
- âœ… Fixed function not delaying the <kbd>Space</kbd> input at all
- âœ… Fixed function unnecessarily delaying the <kbd>Space</kbd> input if the user's PriorKey was a ripple trim, but more than the delay time has passed

ğŸ“ `disableAllMuteSolo()`
- âœ… Fixed function sometimes activating some `Mute` icons
- ğŸ“‹ Will now wait for some activation hotkeys to be released before continuing

### ğŸ“ `Startup {`
- âœ… Fixed `updatePackages()` using incorrect string for newer versions of `chocolatey` causing the update process to fail
- âœ… Fixed `libUpdateCheck()` updating the `Icons.dll` file when it wasn't necessary causing false diffs in git
- âœ… Fixed `generate()` not fixing the `settings.ini` file in the event that; a setting had been renamed, or one setting had been removed and a new one added at the same time
- âŒ Removed `updateAdobeVerAHK()`
- âœï¸ Added `checkVersJSON()`
- ğŸ“‹ `gitBranchCheck()` will no longer continue if changes are waiting to be `pushed` to avoid issues
- ğŸ“‹ `adobeVerOverride()` will now show the user's selected Premiere `theme` during its selected version `Notify {`

ğŸ“ `HotkeylessAHK.ahk`
- ğŸ“‹ Can now be rebooted from `trayMen()`
- ğŸ“‹ The user will be alerted about whether script is open/closed on script reboot

### ğŸ“ `settingsGUI()`
- âœ… Fixed function throwing when trying to adjust some checkboxes
- âœï¸ Added ability to adjust `swapPreviousSequence()` check rate
- âœï¸ Added ability to enable/disable `swapPreviousSequence()` check rate
- ğŸ“‹ GUI will no longer open until the `Settings changes are being saved` notify GUI closes so that changes are properly reflected

## Other Changes
- âœ… Fixed `reencodeGUI()` not respecting the set `bitrate` value
- âœï¸ Added `PremiereRemote` function `toggleEnabled()` & `closeActiveSequence()`
- âŒ Removed `audPart.ahk`, `audSelect.ahk`, `projAudio.ahk`, `projVideo.ahk`, `sfx.ahk`, `thumbnail.ahk`, `vfx.ahk`, `video.ahk`, `vidPart.ahk`, and `vidSelect.ahk` as `mult-dl.ahk` encapsulates all of them

ğŸ”— `Premiere_RightClick.ahk`
- âœ… Fixed script throwing due to `GetKeyState` in some scenarios
- ğŸ“‹ Moved `timelineColours {` out of `Premiere_RightClick.ahk` and into its own file `Premiere_TimelineColours.ahk`
- ğŸ“‹ Moved `__setTimelineCol()` out of `Premiere_RightClick.ahk` and into `prem {`

ğŸ”— `mult-dl.ahk`
- âœï¸ Can now download thumbnails
- ğŸ“‹ Will default its `FileSelect` to an active `Explorer` window if one is present
- ğŸ“‹ Will now properly limit the `Part` tabs `UpDwn` inputs to 2 values and only numbers
- ğŸ“‹ Will attempt to select the downloaded file in the `explorer` window

ğŸ”— `generateProxies.ahk`
- âœ… Fixed script failing to generate some metadata causing it to outright fail
- âœ… Fixed script attempting to operate on non video files
- âœ… Fixed script failing to recurse correctly
- ğŸ“‹ Will default its `FileSelect` to an active `Explorer` window if one is present

.

.

.

# <> Release 2.16.1 - Hotfix

## Functions
- âœ… Fixed `getHotkeys()` failing to return `Fxx` keys
- âœ… Fixed `switchTo.explorerHighlightFile()` failing to focus a directory if a window already existed, causing it to open a new instance
- âœ… Fixed `settingsGUI()` changes not sticking after a reload
- âœï¸ Added `getHotkeysArr()`
- ğŸ“‹ `reset {` functions should now more reliably handle `HotkeylessAHK` causing the script to hang less often

### ğŸ“ `keys {`

ğŸ“ `allWait()`
- ğŸ“‹ Now uses `getHotkeysArr()` instead of heavy string manipulation
- ğŸ“‹ Parameter `which` is now an `Integer` instead of a `String`

### ğŸ“ `startup {`
- âœ… Fixed `adobeVerOverride()` showing the currently set adobe versions twice
- ğŸ“‹ `trayMenu()` will now attempt once to open `HotkeylessAHK` if it is closed

### ğŸ“ `ffmpeg {`
- âœ… Fixed `isVideo()` incorrectly labelling some video files as non videos
- ğŸ“‹ Process completed alert now uses `Notify {`

### ğŸ“ `ytdlp {`
- âœ… Fixed `download()` setting `currentName` incorrectly if the user is using the default audio command
- ğŸ“‹ Process completed alert now uses `Notify {`

### ğŸ“ `ps {`
- âŒ Removed `Save()`
- ğŸ“‹ `Type()` now uses UIA to set the correct filetype making it vastly more reliable

## Other Changes
- âœ… Fixed `mult-dl.ahk` throwing when attempting to highlight the output file
- ğŸ“‹ This repo's version of `HotkeylessAHK` is now stored in `..\Backups\Adobe Backups\Premiere\HotkeylessAHK\HotkeylessAHK.ahk`

.

.

.

# <> Release 2.16.2 - Fixes and Features
> [!Caution]
> If the user uses `PremiereRemote` and isn't doing a clean install, this release requires the user to run `..\Backups\Adobe Backups\Premiere\PremiereRemote\replaceAndReset.ahk` as some functions have been updated.

## Functions
- âœ… Fixed `keys.allWait()` stopping a hotkey too early
- âœ… Fixed `getHotkeys()` incorrectly returning boolean `false` in some circumstances
- âœ… Fixed `ffmpeg.isVideo()` throwing if the file does not exist
- âœ… Fixed `startup().trayMen()` throwing if the user tries to close `HotkeylessAHK` while it isn't open
- ğŸ“‹ `premUIA_Values {` will now check for stuck keys after completion 

### ğŸ“ `getHotkeysArr()`
- âœ… Fixed function returning <kbd><!</kbd> as `<` & `!` instead of as one hotkey
- âœ… Fixed function being case sensitive when it shouldn't have been
- ğŸ“‹ Will now return all hotkeys as `vk` values instead of a mix of `vk` and regular strings

### ğŸ“ `ytdlp {`
- âŒ Removed `handleDownload()` as it was unused

ğŸ“ `download()`
- âœ… Fixed function failing to download audio when `ytdlp.defaultAudioCommand` is passed
- âŒ Removed functionality that checks the `Clipboard` for a URL
- ğŸ“‹ Now accepts parameter `filename`
- ğŸ“‹ Now accepts parameter `cookies`
- ğŸ“‹ Downloads will now default to `\Downloads\Tomshi` instead of `A_ScriptDir`
- ğŸ“‹ No longer returns the URL after completion

> [!Caution]
> This version changes the order of parameters to include `filename`. If you use this function anywhere it is recommended to double check your paramaters and make any necessary adjustments

### ğŸ“ `prem {`
- âœ… Fixed `gain()` attempting to continue even if a clip is not selected
- âœ… Fixed failed attempts to create a UIA object causing the script to throw
- âœ… Fixed `zoomPreviewWindow()` firing while the user is typing
- âœï¸ Added `changeDupeFrameMarkers()`
- âœï¸ Added `isEditTabActive()`
- ğŸ“‹ Renamed `__checkTimeline()` => `__setTimelineValues()`
- ğŸ“‹ Renamed `__checkTimelineFocus()` => `__focusTimeline()`

ğŸ“ `save()`
- âœ… Fixed function not properly determining if `Premiere` may be busy
- âœ… Fixed function throwing if it makes an attempt while `Premiere` has crashed

ğŸ“ `changeLabel()`
- âœ… Fixed function throwing if activated with `HotkeylessAHK` while `Premiere` was not the active window
- âœ… Fixed function sending hotkeys even if a clip was not selected

ğŸ“ `toggleEnabled()`
- âœ… Fixed function sometimes not deselecting clips
- âœï¸ Now accepts parameter `allExcept` to toggle all tracks *except* the desired track *or* all tracks beyond the `offset` value
- ğŸ“‹ Can now instantly change multiple tracks if the user places the activation hotkeys correctly. (see the [wiki for more info](<https://github.com/Tomshiii/ahk/wiki/Adobe-Functions#premtoggleenabled>))
- ğŸ“‹ Will now move the playhead out of the way if the cursor is hovering over it
- ğŸ“‹ Will now check the initial state of the selection and reattempt a failed toggle
- ğŸ“‹ Will now use `PremiereRemote` to determine the max clip length to check for
> [!Caution]
> This function requires updated `PremiereRemote` functions.

## Other Changes
- âœ… Fixed `backupProj.ahk` operating on the incorrect folder if; a Premiere project is open, but another project is selected
- âœ… Fixed `zip prem proj.ahk` not copying extra directories the user agrees to copying
- âœï¸ Added `replaceAndReset.ahk` `PremiereRemote` script
- âœï¸ Added `HighPrecisionSleep` by [thqby](<https://github.com/thqby/ahk2_lib/blob/master/HighPrecisionSleep.ahk>)
- âœï¸ Added `ShinsImageScanClass` by [Spawnova](<https://github.com/Spawnova/ShinsImageScanClass/blob/main/AHK%20V2/ShinsImageScanClass.ahk>)

ğŸ”— `mult-dl.ahk`
###### *(v1.1.8.2 -> v1.2.3)*
- âœ… Fixed script throwing while attempting to download thumbnails
- âœï¸ Added new icon
- âœï¸ Custom filenames can be set for downloaded files when using `Single`/`Part`
- ğŸ“‹ Downloads will now simply default to `..\Downloads\tomshi`
- ğŸ“‹ Use of cookies can now be toggled

ğŸ”— `autosave.ahk`
- âœ… Fixed `__savePrem()` not properly determining when `Premiere` may be busy
- âœ… Fixed `__saveAE()` causing an idle check even if a save wasn't required
- ğŸ“‹ `__reactivateWindow()` will no longer reactivate `Premiere` if it was the original window but `PremiereRemote` was used to save
- ğŸ“‹ Will now show visually when the next save attempt will occur
- ğŸ“‹ Will now check if `Premiere` is on the edit tab and cancel the save attempt if it isn't

ğŸ”— `PremiereRemote`
- âœï¸ Added `isClipEnabled()`
- âœï¸ Added `movePlayheadFrames()`
- âœï¸ Added `getAudioTracks()`/`getVideoTracks()`

.

.

.

